<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />

    <title>Svelte app</title>
    <link rel="stylesheet" href="./index.css" />

    <style>
      .item.first {
        border-left: 1px solid green;
      }

      .item.last {
        border-right: 1px solid blue;
      }
      */ .teste {
        background-color: black;
      }

      th,
      td {
        border: 1px solid black;
      }

      span.slice {
        border: 1px solid red;
        min-width: 20px;
        min-height: 30px;
        float: left;
      }
    </style>
  </head>

  <body>
    <div id="teste"></div>
  </body>

  <script type="module" src="./index.js"></script>
  <script type="module">
    function addDays(date, days) {
      const copy = new Date(Number(date));
      copy.setDate(date.getDate() + days);
      return copy;
    }

    function addHours(date, hours) {
      const copy = new Date(Number(date));
      copy.setHours(copy.getHours() + hours);
      return copy;
    }

    const padding = 15;
    const today = new Date(2020, 3, 25, 11, 0, 0, 0);
    today.setTime(today.getTime() - 3 * 60 * 60 * 1000); //com timezone -3

    let startDate = addDays(today, -padding);
    startDate.setHours(0, 0, 0, 0);
    startDate = startDate.getTime();

    let endDate = addDays(today, padding);
    endDate.setHours(0, 0, 0, 0);
    endDate = endDate.getTime();

    const rows = [
      {
        headers: [
          {
            title: "Item 1",
            content: "abc",
          },
        ],
        items: [
          {
            content: "teste",
            title: "teste",
            class: "teste",
            startDate: addDays(today, -1).getTime(),
            endDate: addDays(today, 1).getTime(),
          },
        ],
        expanded: false,
        children: [
          {
            headers: [
              {
                content: "SubItem 1",
                title: "sub 1",
              },
            ],
            items: [
              {
                details: "teste1",
                startDate: addDays(today, -1).getTime(),
                endDate: addDays(today, -1).getTime(),
              },
            ],
          },
          {
            headers: [
              {
                content: "SubItem 2",
                title: "sub 2",
              },
            ],
            items: [
              {
                details: "teste2",
                startDate: addDays(today, 0).getTime(),
                endDate: addHours(today, 12).getTime(),
              },
            ],
          },
          {
            headers: [
              {
                content: "SubItem 3",
                title: "sub 3",
              },
            ],
            items: [
              {
                details: "teste3",
                startDate: addDays(today, 1).getTime(),
                endDate: addDays(today, 1).getTime(),
              },
            ],
          },
        ],
      },
    ];

    const gantt = new Gantt({
      target: document.getElementById("teste"),
      props: {
        formatSlice,
        slicesSize: 1000 * 60 * 60 * 12, //12 horas
        //slicesSize: 1000 * 60 * 60 * 24 * 1, //1 dia
        zoom: 1000 * 60 * 60 * 24 * 1, //1 dia
        startDate,
        endDate,
        headers: getHeaders(),
        rows,
      },
    });

    // setTimeout(() => {
    //   gantt.$set({
    //     slicesSize: 1000 * 60 * 60 * 24 * 1,
    //   });
    // }, 2000);

    function formatSlice(column, slice) {
      return {
        content: slice.startDate + "/" + slice.endDate,
        title: new Date(slice.startDate),
        ...slice,
      };
    }

    function getHeaders() {
      const monthNames = [
        "January",
        "February",
        "March",
        "April",
        "May",
        "June",
        "July",
        "August",
        "September",
        "October",
        "November",
        "December",
      ];

      return (columns, slices, slicesCount, slicesSize, zoom) => {
        return "<tr><th>ij</th></tr>";
      };
    }
  </script>
</html>
